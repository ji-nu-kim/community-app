{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport AppLayout from '../components/Layouts/AppLayout';\nimport React, { memo, useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { loadCountryCommunitiesRequestAction } from 'actions/actionCommunity';\nimport BoxStyleCard from 'components/Cards/BoxStyleCard';\nimport HomeLayout from 'components/Layouts/HomeLayout';\nimport Link from 'next/link';\n\nfunction Home() {\n  var dispatch = useDispatch();\n\n  var _useSelector = useSelector(function (state) {\n    return state.user;\n  }),\n      me = _useSelector.me;\n\n  var _useSelector2 = useSelector(function (state) {\n    return state.community;\n  }),\n      mainCommunities = _useSelector2.mainCommunities,\n      changableCommunities = _useSelector2.changableCommunities,\n      hasMoreCommunity = _useSelector2.hasMoreCommunity,\n      loadCommunitiesLoading = _useSelector2.loadCommunitiesLoading;\n\n  useEffect(function () {\n    if (me !== null && me !== void 0 && me.country) {\n      dispatch(loadCountryCommunitiesRequestAction({\n        country: me.country,\n        communityId: 0\n      }));\n    }\n  }, [me === null || me === void 0 ? void 0 : me.country]);\n  useEffect(function () {\n    function onScroll() {\n      if (me !== null && me !== void 0 && me.country && changableCommunities.length) {\n        console.log(1);\n\n        if (window.scrollY + document.documentElement.clientHeight >= document.documentElement.scrollHeight - 200) {\n          console.log(2);\n\n          if (hasMoreCommunity && !loadCommunitiesLoading) {\n            console.log(3);\n            var lastId = changableCommunities[changableCommunities.length - 1].id;\n            dispatch(loadCountryCommunitiesRequestAction({\n              country: me.country,\n              communityId: lastId\n            }));\n          }\n        }\n      }\n    }\n\n    window.addEventListener('scroll', onScroll);\n    return function () {\n      return window.removeEventListener('scroll', onScroll);\n    };\n  }, [hasMoreCommunity, loadCommunitiesLoading, changableCommunities, me]);\n  return /*#__PURE__*/_jsx(AppLayout, {\n    children: /*#__PURE__*/_jsxs(HomeLayout, {\n      children: [/*#__PURE__*/_jsxs(\"section\", {\n        children: [/*#__PURE__*/_jsx(\"h1\", {\n          children: \"\\uC0C8\\uB85C\\uC6B4 \\uCEE4\\uBBA4\\uB2C8\\uD2F0\\uB97C \\uB9CC\\uB098\\uBCF4\\uC138\\uC694\"\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: \"cards-container\",\n          children: mainCommunities.map(function (community) {\n            return /*#__PURE__*/_jsx(\"div\", {\n              children: /*#__PURE__*/_jsx(Link, {\n                href: \"/community/\".concat(community.id),\n                children: /*#__PURE__*/_jsx(\"a\", {\n                  children: /*#__PURE__*/_jsx(BoxStyleCard, {\n                    profilePhoto: community.profilePhoto,\n                    categoryName: community.Categories[0].name,\n                    country: community.country,\n                    communityName: community.communityName\n                  })\n                })\n              })\n            }, \"new\".concat(community.id));\n          })\n        })]\n      }), me && changableCommunities && /*#__PURE__*/_jsxs(\"section\", {\n        children: [/*#__PURE__*/_jsx(\"h1\", {\n          children: \"\\uC6B0\\uB9AC\\uB3D9\\uB124 \\uCEE4\\uBBA4\\uB2C8\\uD2F0\"\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: \"cards-container\",\n          children: changableCommunities.map(function (community) {\n            return /*#__PURE__*/_jsx(\"div\", {\n              children: /*#__PURE__*/_jsx(Link, {\n                href: \"/community/\".concat(community.id),\n                children: /*#__PURE__*/_jsx(\"a\", {\n                  children: /*#__PURE__*/_jsx(BoxStyleCard, {\n                    profilePhoto: community.profilePhoto,\n                    categoryName: community.Categories[0].name,\n                    country: community.country,\n                    communityName: community.communityName\n                  })\n                })\n              })\n            }, \"country\".concat(community.id));\n          })\n        })]\n      })]\n    })\n  });\n}\n\nexport var __N_SSP = true;\nexport default /*#__PURE__*/memo(Home);","map":{"version":3,"sources":["C:/Users/wlsdn/Desktop/next/community/front/pages/index.tsx"],"names":["AppLayout","React","memo","useEffect","useDispatch","useSelector","loadCountryCommunitiesRequestAction","BoxStyleCard","HomeLayout","Link","Home","dispatch","state","user","me","community","mainCommunities","changableCommunities","hasMoreCommunity","loadCommunitiesLoading","country","communityId","onScroll","length","console","log","window","scrollY","document","documentElement","clientHeight","scrollHeight","lastId","id","addEventListener","removeEventListener","map","profilePhoto","Categories","name","communityName"],"mappings":"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","sourcesContent":["import AppLayout from '../components/Layouts/AppLayout';\nimport React, { memo, useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { END } from 'redux-saga';\nimport axios from 'axios';\nimport { RootStateInterface } from '../interfaces/RootState';\nimport { loadMyInfoRequestAction } from 'actions/actionUser';\nimport {\n  loadCommunitiesRequestAction,\n  loadCountryCommunitiesRequestAction,\n} from 'actions/actionCommunity';\nimport wrapper from 'store/configureStore';\nimport { GetServerSideProps } from 'next';\nimport BoxStyleCard from 'components/Cards/BoxStyleCard';\nimport HomeLayout from 'components/Layouts/HomeLayout';\nimport Link from 'next/link';\n\nfunction Home() {\n  const dispatch = useDispatch();\n  const { me } = useSelector((state: RootStateInterface) => state.user);\n  const {\n    mainCommunities,\n    changableCommunities,\n    hasMoreCommunity,\n    loadCommunitiesLoading,\n  } = useSelector((state: RootStateInterface) => state.community);\n\n  useEffect(() => {\n    if (me?.country) {\n      dispatch(\n        loadCountryCommunitiesRequestAction({\n          country: me.country,\n          communityId: 0,\n        })\n      );\n    }\n  }, [me?.country]);\n\n  useEffect(() => {\n    function onScroll() {\n      if (me?.country && changableCommunities.length) {\n        console.log(1);\n        if (\n          window.scrollY + document.documentElement.clientHeight >=\n          document.documentElement.scrollHeight - 200\n        ) {\n          console.log(2);\n          if (hasMoreCommunity && !loadCommunitiesLoading) {\n            console.log(3);\n            const lastId = changableCommunities[changableCommunities.length - 1].id;\n            dispatch(\n              loadCountryCommunitiesRequestAction({\n                country: me.country,\n                communityId: lastId,\n              })\n            );\n          }\n        }\n      }\n    }\n    window.addEventListener('scroll', onScroll);\n\n    return () => window.removeEventListener('scroll', onScroll);\n  }, [hasMoreCommunity, loadCommunitiesLoading, changableCommunities, me]);\n\n  return (\n    <AppLayout>\n      <HomeLayout>\n        {/* 유저정보가 없어도 보여지는 카드 */}\n        <section>\n          <h1>새로운 커뮤니티를 만나보세요</h1>\n          <div className=\"cards-container\">\n            {mainCommunities.map(community => (\n              <div key={`new${community.id}`}>\n                <Link href={`/community/${community.id}`}>\n                  <a>\n                    <BoxStyleCard\n                      profilePhoto={community.profilePhoto}\n                      categoryName={community.Categories[0].name}\n                      country={community.country}\n                      communityName={community.communityName}\n                    />\n                  </a>\n                </Link>\n              </div>\n            ))}\n          </div>\n        </section>\n\n        {/* 유저정보가 있을 때 보여지는 카드  */}\n        {me && changableCommunities && (\n          <section>\n            <h1>우리동네 커뮤니티</h1>\n            <div className=\"cards-container\">\n              {changableCommunities.map(community => (\n                <div key={`country${community.id}`}>\n                  <Link href={`/community/${community.id}`}>\n                    <a>\n                      <BoxStyleCard\n                        profilePhoto={community.profilePhoto}\n                        categoryName={community.Categories[0].name}\n                        country={community.country}\n                        communityName={community.communityName}\n                      />\n                    </a>\n                  </Link>\n                </div>\n              ))}\n            </div>\n          </section>\n        )}\n      </HomeLayout>\n    </AppLayout>\n  );\n}\n\nexport const getServerSideProps: GetServerSideProps = wrapper.getServerSideProps(\n  async context => {\n    const cookie = context.req ? context.req.headers.cookie : '';\n    axios.defaults.headers.Cookie = '';\n    if (context.req && cookie) {\n      axios.defaults.headers.Cookie = cookie;\n    }\n    context.store.dispatch(loadMyInfoRequestAction());\n    context.store.dispatch(loadCommunitiesRequestAction());\n    context.store.dispatch(END);\n    await context.store.sagaTask.toPromise();\n  }\n);\n\nexport default memo(Home);\n"]},"metadata":{},"sourceType":"module"}