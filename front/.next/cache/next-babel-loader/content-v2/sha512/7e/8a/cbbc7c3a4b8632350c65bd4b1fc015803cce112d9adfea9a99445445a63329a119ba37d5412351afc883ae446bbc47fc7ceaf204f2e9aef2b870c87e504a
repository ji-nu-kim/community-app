{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport React, { memo, useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport dynamic from 'next/dynamic';\nimport Link from 'next/link';\nimport Head from 'next/head';\nimport { loadCountryCommunitiesRequestAction } from 'actions/actionCommunity';\nvar BoxStyleCard = dynamic(function () {\n  return import('components/Cards/BoxStyleCard');\n}, {\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak('components/Cards/BoxStyleCard')];\n    },\n    modules: [\"index.tsx -> \" + 'components/Cards/BoxStyleCard']\n  }\n});\nvar HomeLayout = dynamic(function () {\n  return import('components/Layouts/HomeLayout');\n}, {\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak('components/Layouts/HomeLayout')];\n    },\n    modules: [\"index.tsx -> \" + 'components/Layouts/HomeLayout']\n  }\n});\nvar AppLayout = dynamic(function () {\n  return import('components/Layouts/AppLayout');\n}, {\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak('components/Layouts/AppLayout')];\n    },\n    modules: [\"index.tsx -> \" + 'components/Layouts/AppLayout']\n  }\n});\n\nfunction Home() {\n  var dispatch = useDispatch();\n\n  var _useSelector = useSelector(function (state) {\n    return state.user;\n  }),\n      me = _useSelector.me;\n\n  var _useSelector2 = useSelector(function (state) {\n    return state.community;\n  }),\n      mainCommunities = _useSelector2.mainCommunities,\n      changableCommunities = _useSelector2.changableCommunities,\n      hasMoreCommunity = _useSelector2.hasMoreCommunity,\n      loadCommunitiesLoading = _useSelector2.loadCommunitiesLoading;\n\n  useEffect(function () {\n    if (me !== null && me !== void 0 && me.country) {\n      dispatch(loadCountryCommunitiesRequestAction({\n        country: me.country,\n        communityId: 0\n      }));\n    }\n  }, [me === null || me === void 0 ? void 0 : me.country]);\n  useEffect(function () {\n    function onScroll() {\n      if (me !== null && me !== void 0 && me.country && changableCommunities.length) {\n        if (window.scrollY + document.documentElement.clientHeight >= document.documentElement.scrollHeight - 200) {\n          if (hasMoreCommunity && !loadCommunitiesLoading) {\n            var lastId = changableCommunities[changableCommunities.length - 1].id;\n            dispatch(loadCountryCommunitiesRequestAction({\n              country: me.country,\n              communityId: lastId\n            }));\n          }\n        }\n      }\n    }\n\n    window.addEventListener('scroll', onScroll);\n    return function () {\n      return window.removeEventListener('scroll', onScroll);\n    };\n  }, [hasMoreCommunity, loadCommunitiesLoading, changableCommunities, me]);\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [/*#__PURE__*/_jsx(Head, {\n      children: /*#__PURE__*/_jsx(\"link\", {\n        href: \"https://fonts.googleapis.com/css2?family=Luckiest+Guy&display=swap\",\n        rel: \"stylesheet\"\n      })\n    }), /*#__PURE__*/_jsx(AppLayout, {\n      children: /*#__PURE__*/_jsxs(HomeLayout, {\n        children: [/*#__PURE__*/_jsxs(\"section\", {\n          children: [/*#__PURE__*/_jsx(\"h1\", {\n            children: \"\\uC0C8\\uB85C\\uC6B4 \\uCEE4\\uBBA4\\uB2C8\\uD2F0\\uB97C \\uB9CC\\uB098\\uBCF4\\uC138\\uC694\"\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: \"cards-container\",\n            children: mainCommunities.map(function (community) {\n              return /*#__PURE__*/_jsx(\"div\", {\n                children: /*#__PURE__*/_jsx(Link, {\n                  href: \"/community/\".concat(community.id),\n                  prefetch: false,\n                  children: /*#__PURE__*/_jsx(\"a\", {\n                    children: /*#__PURE__*/_jsx(BoxStyleCard, {\n                      profilePhoto: community.profilePhoto,\n                      categoryName: community.Categories[0].name,\n                      country: community.country,\n                      communityName: community.communityName\n                    })\n                  })\n                })\n              }, \"new\".concat(community.id));\n            })\n          })]\n        }), me && changableCommunities && /*#__PURE__*/_jsxs(\"section\", {\n          children: [/*#__PURE__*/_jsx(\"h1\", {\n            children: \"\\uC6B0\\uB9AC\\uB3D9\\uB124 \\uCEE4\\uBBA4\\uB2C8\\uD2F0\"\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: \"cards-container\",\n            children: changableCommunities.map(function (community) {\n              return /*#__PURE__*/_jsx(\"div\", {\n                children: /*#__PURE__*/_jsx(Link, {\n                  href: \"/community/\".concat(community.id),\n                  prefetch: false,\n                  children: /*#__PURE__*/_jsx(\"a\", {\n                    children: /*#__PURE__*/_jsx(BoxStyleCard, {\n                      profilePhoto: community.profilePhoto,\n                      categoryName: community.Categories[0].name,\n                      country: community.country,\n                      communityName: community.communityName\n                    })\n                  })\n                })\n              }, \"country\".concat(community.id));\n            })\n          })]\n        })]\n      })\n    })]\n  });\n}\n\nexport var __N_SSP = true;\nexport default /*#__PURE__*/memo(Home);","map":{"version":3,"sources":["C:/Users/wlsdn/Desktop/next/community/front/pages/index.tsx"],"names":["React","memo","useEffect","useDispatch","useSelector","dynamic","Link","Head","loadCountryCommunitiesRequestAction","BoxStyleCard","HomeLayout","AppLayout","Home","dispatch","state","user","me","community","mainCommunities","changableCommunities","hasMoreCommunity","loadCommunitiesLoading","country","communityId","onScroll","length","window","scrollY","document","documentElement","clientHeight","scrollHeight","lastId","id","addEventListener","removeEventListener","map","profilePhoto","Categories","name","communityName"],"mappings":"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","sourcesContent":["import axios from 'axios';\nimport React, { memo, useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { END } from 'redux-saga';\nimport dynamic from 'next/dynamic';\nimport { GetServerSideProps } from 'next';\nimport Link from 'next/link';\nimport Head from 'next/head';\nimport { RootStateInterface } from 'interfaces/RootState';\nimport { loadMyInfoRequestAction } from 'actions/actionUser';\nimport {\n  loadCommunitiesRequestAction,\n  loadCountryCommunitiesRequestAction,\n} from 'actions/actionCommunity';\nimport wrapper from 'store/configureStore';\n\nconst BoxStyleCard = dynamic(() => import('components/Cards/BoxStyleCard'));\nconst HomeLayout = dynamic(() => import('components/Layouts/HomeLayout'));\nconst AppLayout = dynamic(() => import('components/Layouts/AppLayout'));\n\nfunction Home() {\n  const dispatch = useDispatch();\n  const { me } = useSelector((state: RootStateInterface) => state.user);\n  const {\n    mainCommunities,\n    changableCommunities,\n    hasMoreCommunity,\n    loadCommunitiesLoading,\n  } = useSelector((state: RootStateInterface) => state.community);\n\n  useEffect(() => {\n    if (me?.country) {\n      dispatch(\n        loadCountryCommunitiesRequestAction({\n          country: me.country,\n          communityId: 0,\n        })\n      );\n    }\n  }, [me?.country]);\n\n  useEffect(() => {\n    function onScroll() {\n      if (me?.country && changableCommunities.length) {\n        if (\n          window.scrollY + document.documentElement.clientHeight >=\n          document.documentElement.scrollHeight - 200\n        ) {\n          if (hasMoreCommunity && !loadCommunitiesLoading) {\n            const lastId = changableCommunities[changableCommunities.length - 1].id;\n            dispatch(\n              loadCountryCommunitiesRequestAction({\n                country: me.country,\n                communityId: lastId,\n              })\n            );\n          }\n        }\n      }\n    }\n    window.addEventListener('scroll', onScroll);\n\n    return () => window.removeEventListener('scroll', onScroll);\n  }, [hasMoreCommunity, loadCommunitiesLoading, changableCommunities, me]);\n\n  return (\n    <>\n      <Head>\n        <link\n          href=\"https://fonts.googleapis.com/css2?family=Luckiest+Guy&display=swap\"\n          rel=\"stylesheet\"\n        />\n      </Head>\n      <AppLayout>\n        <HomeLayout>\n          <section>\n            <h1>새로운 커뮤니티를 만나보세요</h1>\n            <div className=\"cards-container\">\n              {mainCommunities.map(community => (\n                <div key={`new${community.id}`}>\n                  <Link href={`/community/${community.id}`} prefetch={false}>\n                    <a>\n                      <BoxStyleCard\n                        profilePhoto={community.profilePhoto}\n                        categoryName={community.Categories[0].name}\n                        country={community.country}\n                        communityName={community.communityName}\n                      />\n                    </a>\n                  </Link>\n                </div>\n              ))}\n            </div>\n          </section>\n\n          {me && changableCommunities && (\n            <section>\n              <h1>우리동네 커뮤니티</h1>\n              <div className=\"cards-container\">\n                {changableCommunities.map(community => (\n                  <div key={`country${community.id}`}>\n                    <Link href={`/community/${community.id}`} prefetch={false}>\n                      <a>\n                        <BoxStyleCard\n                          profilePhoto={community.profilePhoto}\n                          categoryName={community.Categories[0].name}\n                          country={community.country}\n                          communityName={community.communityName}\n                        />\n                      </a>\n                    </Link>\n                  </div>\n                ))}\n              </div>\n            </section>\n          )}\n        </HomeLayout>\n      </AppLayout>\n    </>\n  );\n}\n\nexport const getServerSideProps: GetServerSideProps = wrapper.getServerSideProps(\n  async context => {\n    const cookie = context.req ? context.req.headers.cookie : '';\n    axios.defaults.headers.Cookie = '';\n    if (context.req && cookie) {\n      axios.defaults.headers.Cookie = cookie;\n    }\n    context.store.dispatch(loadMyInfoRequestAction());\n    context.store.dispatch(loadCommunitiesRequestAction());\n    context.store.dispatch(END);\n    await context.store.sagaTask.toPromise();\n  }\n);\n\nexport default memo(Home);\n"]},"metadata":{},"sourceType":"module"}