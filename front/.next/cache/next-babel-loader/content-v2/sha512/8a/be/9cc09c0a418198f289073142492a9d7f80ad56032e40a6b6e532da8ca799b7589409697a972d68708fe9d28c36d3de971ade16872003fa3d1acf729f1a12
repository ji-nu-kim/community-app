{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport axios from 'axios';\nimport React, { memo, useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { END } from 'redux-saga';\nimport dynamic from 'next/dynamic';\nimport Link from 'next/link';\nimport { loadMyInfoRequestAction } from 'actions/actionUser';\nimport { loadCommunitiesRequestAction, loadCountryCommunitiesRequestAction } from 'actions/actionCommunity';\nimport wrapper from 'store/configureStore';\nconst BoxStyleCard = dynamic(() => import('components/Cards/BoxStyleCard'), {\n  loadableGenerated: {\n    webpack: () => [require.resolveWeak('components/Cards/BoxStyleCard')],\n    modules: ['components/Cards/BoxStyleCard']\n  }\n});\nconst HomeLayout = dynamic(() => import('components/Layouts/HomeLayout'), {\n  loadableGenerated: {\n    webpack: () => [require.resolveWeak('components/Layouts/HomeLayout')],\n    modules: ['components/Layouts/HomeLayout']\n  }\n});\nconst AppLayout = dynamic(() => import('components/Layouts/AppLayout'), {\n  loadableGenerated: {\n    webpack: () => [require.resolveWeak('components/Layouts/AppLayout')],\n    modules: ['components/Layouts/AppLayout']\n  }\n});\n\nfunction Home() {\n  const dispatch = useDispatch();\n  const {\n    me\n  } = useSelector(state => state.user);\n  const {\n    mainCommunities,\n    changableCommunities,\n    hasMoreCommunity,\n    loadCommunitiesLoading\n  } = useSelector(state => state.community);\n  useEffect(() => {\n    if (me !== null && me !== void 0 && me.country) {\n      dispatch(loadCountryCommunitiesRequestAction({\n        country: me.country,\n        communityId: 0\n      }));\n    }\n  }, [me === null || me === void 0 ? void 0 : me.country]);\n  useEffect(() => {\n    function onScroll() {\n      if (me !== null && me !== void 0 && me.country && changableCommunities.length) {\n        if (window.scrollY + document.documentElement.clientHeight >= document.documentElement.scrollHeight - 200) {\n          if (hasMoreCommunity && !loadCommunitiesLoading) {\n            const lastId = changableCommunities[changableCommunities.length - 1].id;\n            dispatch(loadCountryCommunitiesRequestAction({\n              country: me.country,\n              communityId: lastId\n            }));\n          }\n        }\n      }\n    }\n\n    window.addEventListener('scroll', onScroll);\n    return () => window.removeEventListener('scroll', onScroll);\n  }, [hasMoreCommunity, loadCommunitiesLoading, changableCommunities, me]);\n  return /*#__PURE__*/_jsx(AppLayout, {\n    children: /*#__PURE__*/_jsxs(HomeLayout, {\n      children: [/*#__PURE__*/_jsxs(\"section\", {\n        children: [/*#__PURE__*/_jsx(\"h1\", {\n          children: \"\\uC0C8\\uB85C\\uC6B4 \\uCEE4\\uBBA4\\uB2C8\\uD2F0\\uB97C \\uB9CC\\uB098\\uBCF4\\uC138\\uC694\"\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: \"cards-container\",\n          children: mainCommunities.map(community => /*#__PURE__*/_jsx(\"div\", {\n            children: /*#__PURE__*/_jsx(Link, {\n              href: `/community/${community.id}`,\n              prefetch: false,\n              children: /*#__PURE__*/_jsx(\"a\", {\n                children: /*#__PURE__*/_jsx(BoxStyleCard, {\n                  profilePhoto: community.profilePhoto,\n                  categoryName: community.Categories[0].name,\n                  country: community.country,\n                  communityName: community.communityName\n                })\n              })\n            })\n          }, `new${community.id}`))\n        })]\n      }), me && changableCommunities && /*#__PURE__*/_jsxs(\"section\", {\n        children: [/*#__PURE__*/_jsx(\"h1\", {\n          children: \"\\uC6B0\\uB9AC\\uB3D9\\uB124 \\uCEE4\\uBBA4\\uB2C8\\uD2F0\"\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: \"cards-container\",\n          children: changableCommunities.map(community => /*#__PURE__*/_jsx(\"div\", {\n            children: /*#__PURE__*/_jsx(Link, {\n              href: `/community/${community.id}`,\n              prefetch: false,\n              children: /*#__PURE__*/_jsx(\"a\", {\n                children: /*#__PURE__*/_jsx(BoxStyleCard, {\n                  profilePhoto: community.profilePhoto,\n                  categoryName: community.Categories[0].name,\n                  country: community.country,\n                  communityName: community.communityName\n                })\n              })\n            })\n          }, `country${community.id}`))\n        })]\n      })]\n    })\n  });\n}\n\nexport const getServerSideProps = wrapper.getServerSideProps(async context => {\n  const cookie = context.req ? context.req.headers.cookie : '';\n  axios.defaults.headers.Cookie = '';\n\n  if (context.req && cookie) {\n    axios.defaults.headers.Cookie = cookie;\n  }\n\n  context.store.dispatch(loadMyInfoRequestAction());\n  context.store.dispatch(loadCommunitiesRequestAction());\n  context.store.dispatch(END);\n  await context.store.sagaTask.toPromise();\n});\nexport default /*#__PURE__*/memo(Home);","map":{"version":3,"sources":["C:/Users/wlsdn/Desktop/next/community/front/pages/index.tsx"],"names":["axios","React","memo","useEffect","useDispatch","useSelector","END","dynamic","Link","loadMyInfoRequestAction","loadCommunitiesRequestAction","loadCountryCommunitiesRequestAction","wrapper","BoxStyleCard","HomeLayout","AppLayout","Home","dispatch","me","state","user","mainCommunities","changableCommunities","hasMoreCommunity","loadCommunitiesLoading","community","country","communityId","onScroll","length","window","scrollY","document","documentElement","clientHeight","scrollHeight","lastId","id","addEventListener","removeEventListener","map","profilePhoto","Categories","name","communityName","getServerSideProps","context","cookie","req","headers","defaults","Cookie","store","sagaTask","toPromise"],"mappings":";;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,KAAP,IAAgBC,IAAhB,EAAsBC,SAAtB,QAAuC,OAAvC;AACA,SAASC,WAAT,EAAsBC,WAAtB,QAAyC,aAAzC;AACA,SAASC,GAAT,QAAoB,YAApB;AACA,OAAOC,OAAP,MAAoB,cAApB;AAEA,OAAOC,IAAP,MAAiB,WAAjB;AAEA,SAASC,uBAAT,QAAwC,oBAAxC;AACA,SACEC,4BADF,EAEEC,mCAFF,QAGO,yBAHP;AAIA,OAAOC,OAAP,MAAoB,sBAApB;AAEA,MAAMC,YAAY,GAAGN,OAAO,CAAC,MAAM,OAAO,+BAAP,CAAP;AAAA;AAAA,wCAAc,+BAAd;AAAA,cAAc,+BAAd;AAAA;AAAA,EAA5B;AACA,MAAMO,UAAU,GAAGP,OAAO,CAAC,MAAM,OAAO,+BAAP,CAAP;AAAA;AAAA,wCAAc,+BAAd;AAAA,cAAc,+BAAd;AAAA;AAAA,EAA1B;AACA,MAAMQ,SAAS,GAAGR,OAAO,CAAC,MAAM,OAAO,8BAAP,CAAP;AAAA;AAAA,wCAAc,8BAAd;AAAA,cAAc,8BAAd;AAAA;AAAA,EAAzB;;AAEA,SAASS,IAAT,GAAgB;AACd,QAAMC,QAAQ,GAAGb,WAAW,EAA5B;AACA,QAAM;AAAEc,IAAAA;AAAF,MAASb,WAAW,CAAEc,KAAD,IAA+BA,KAAK,CAACC,IAAtC,CAA1B;AACA,QAAM;AACJC,IAAAA,eADI;AAEJC,IAAAA,oBAFI;AAGJC,IAAAA,gBAHI;AAIJC,IAAAA;AAJI,MAKFnB,WAAW,CAAEc,KAAD,IAA+BA,KAAK,CAACM,SAAtC,CALf;AAOAtB,EAAAA,SAAS,CAAC,MAAM;AACd,QAAIe,EAAJ,aAAIA,EAAJ,eAAIA,EAAE,CAAEQ,OAAR,EAAiB;AACfT,MAAAA,QAAQ,CACNN,mCAAmC,CAAC;AAClCe,QAAAA,OAAO,EAAER,EAAE,CAACQ,OADsB;AAElCC,QAAAA,WAAW,EAAE;AAFqB,OAAD,CAD7B,CAAR;AAMD;AACF,GATQ,EASN,CAACT,EAAD,aAACA,EAAD,uBAACA,EAAE,CAAEQ,OAAL,CATM,CAAT;AAWAvB,EAAAA,SAAS,CAAC,MAAM;AACd,aAASyB,QAAT,GAAoB;AAClB,UAAIV,EAAE,SAAF,IAAAA,EAAE,WAAF,IAAAA,EAAE,CAAEQ,OAAJ,IAAeJ,oBAAoB,CAACO,MAAxC,EAAgD;AAC9C,YACEC,MAAM,CAACC,OAAP,GAAiBC,QAAQ,CAACC,eAAT,CAAyBC,YAA1C,IACAF,QAAQ,CAACC,eAAT,CAAyBE,YAAzB,GAAwC,GAF1C,EAGE;AACA,cAAIZ,gBAAgB,IAAI,CAACC,sBAAzB,EAAiD;AAC/C,kBAAMY,MAAM,GAAGd,oBAAoB,CAACA,oBAAoB,CAACO,MAArB,GAA8B,CAA/B,CAApB,CAAsDQ,EAArE;AACApB,YAAAA,QAAQ,CACNN,mCAAmC,CAAC;AAClCe,cAAAA,OAAO,EAAER,EAAE,CAACQ,OADsB;AAElCC,cAAAA,WAAW,EAAES;AAFqB,aAAD,CAD7B,CAAR;AAMD;AACF;AACF;AACF;;AACDN,IAAAA,MAAM,CAACQ,gBAAP,CAAwB,QAAxB,EAAkCV,QAAlC;AAEA,WAAO,MAAME,MAAM,CAACS,mBAAP,CAA2B,QAA3B,EAAqCX,QAArC,CAAb;AACD,GAtBQ,EAsBN,CAACL,gBAAD,EAAmBC,sBAAnB,EAA2CF,oBAA3C,EAAiEJ,EAAjE,CAtBM,CAAT;AAwBA,sBACE,KAAC,SAAD;AAAA,2BACE,MAAC,UAAD;AAAA,8BACE;AAAA,gCACE;AAAA;AAAA,UADF,eAEE;AAAK,UAAA,SAAS,EAAC,iBAAf;AAAA,oBACGG,eAAe,CAACmB,GAAhB,CAAoBf,SAAS,iBAC5B;AAAA,mCACE,KAAC,IAAD;AAAM,cAAA,IAAI,EAAG,cAAaA,SAAS,CAACY,EAAG,EAAvC;AAA0C,cAAA,QAAQ,EAAE,KAApD;AAAA,qCACE;AAAA,uCACE,KAAC,YAAD;AACE,kBAAA,YAAY,EAAEZ,SAAS,CAACgB,YAD1B;AAEE,kBAAA,YAAY,EAAEhB,SAAS,CAACiB,UAAV,CAAqB,CAArB,EAAwBC,IAFxC;AAGE,kBAAA,OAAO,EAAElB,SAAS,CAACC,OAHrB;AAIE,kBAAA,aAAa,EAAED,SAAS,CAACmB;AAJ3B;AADF;AADF;AADF,aAAW,MAAKnB,SAAS,CAACY,EAAG,EAA7B,CADD;AADH,UAFF;AAAA,QADF,EAqBGnB,EAAE,IAAII,oBAAN,iBACC;AAAA,gCACE;AAAA;AAAA,UADF,eAEE;AAAK,UAAA,SAAS,EAAC,iBAAf;AAAA,oBACGA,oBAAoB,CAACkB,GAArB,CAAyBf,SAAS,iBACjC;AAAA,mCACE,KAAC,IAAD;AAAM,cAAA,IAAI,EAAG,cAAaA,SAAS,CAACY,EAAG,EAAvC;AAA0C,cAAA,QAAQ,EAAE,KAApD;AAAA,qCACE;AAAA,uCACE,KAAC,YAAD;AACE,kBAAA,YAAY,EAAEZ,SAAS,CAACgB,YAD1B;AAEE,kBAAA,YAAY,EAAEhB,SAAS,CAACiB,UAAV,CAAqB,CAArB,EAAwBC,IAFxC;AAGE,kBAAA,OAAO,EAAElB,SAAS,CAACC,OAHrB;AAIE,kBAAA,aAAa,EAAED,SAAS,CAACmB;AAJ3B;AADF;AADF;AADF,aAAW,UAASnB,SAAS,CAACY,EAAG,EAAjC,CADD;AADH,UAFF;AAAA,QAtBJ;AAAA;AADF,IADF;AA+CD;;AAED,OAAO,MAAMQ,kBAAsC,GAAGjC,OAAO,CAACiC,kBAAR,CACpD,MAAMC,OAAN,IAAiB;AACf,QAAMC,MAAM,GAAGD,OAAO,CAACE,GAAR,GAAcF,OAAO,CAACE,GAAR,CAAYC,OAAZ,CAAoBF,MAAlC,GAA2C,EAA1D;AACA/C,EAAAA,KAAK,CAACkD,QAAN,CAAeD,OAAf,CAAuBE,MAAvB,GAAgC,EAAhC;;AACA,MAAIL,OAAO,CAACE,GAAR,IAAeD,MAAnB,EAA2B;AACzB/C,IAAAA,KAAK,CAACkD,QAAN,CAAeD,OAAf,CAAuBE,MAAvB,GAAgCJ,MAAhC;AACD;;AACDD,EAAAA,OAAO,CAACM,KAAR,CAAcnC,QAAd,CAAuBR,uBAAuB,EAA9C;AACAqC,EAAAA,OAAO,CAACM,KAAR,CAAcnC,QAAd,CAAuBP,4BAA4B,EAAnD;AACAoC,EAAAA,OAAO,CAACM,KAAR,CAAcnC,QAAd,CAAuBX,GAAvB;AACA,QAAMwC,OAAO,CAACM,KAAR,CAAcC,QAAd,CAAuBC,SAAvB,EAAN;AACD,CAXmD,CAA/C;AAcP,4BAAepD,IAAI,CAACc,IAAD,CAAnB","sourcesContent":["import axios from 'axios';\nimport React, { memo, useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { END } from 'redux-saga';\nimport dynamic from 'next/dynamic';\nimport { GetServerSideProps } from 'next';\nimport Link from 'next/link';\nimport { RootStateInterface } from 'interfaces/RootState';\nimport { loadMyInfoRequestAction } from 'actions/actionUser';\nimport {\n  loadCommunitiesRequestAction,\n  loadCountryCommunitiesRequestAction,\n} from 'actions/actionCommunity';\nimport wrapper from 'store/configureStore';\n\nconst BoxStyleCard = dynamic(() => import('components/Cards/BoxStyleCard'));\nconst HomeLayout = dynamic(() => import('components/Layouts/HomeLayout'));\nconst AppLayout = dynamic(() => import('components/Layouts/AppLayout'));\n\nfunction Home() {\n  const dispatch = useDispatch();\n  const { me } = useSelector((state: RootStateInterface) => state.user);\n  const {\n    mainCommunities,\n    changableCommunities,\n    hasMoreCommunity,\n    loadCommunitiesLoading,\n  } = useSelector((state: RootStateInterface) => state.community);\n\n  useEffect(() => {\n    if (me?.country) {\n      dispatch(\n        loadCountryCommunitiesRequestAction({\n          country: me.country,\n          communityId: 0,\n        })\n      );\n    }\n  }, [me?.country]);\n\n  useEffect(() => {\n    function onScroll() {\n      if (me?.country && changableCommunities.length) {\n        if (\n          window.scrollY + document.documentElement.clientHeight >=\n          document.documentElement.scrollHeight - 200\n        ) {\n          if (hasMoreCommunity && !loadCommunitiesLoading) {\n            const lastId = changableCommunities[changableCommunities.length - 1].id;\n            dispatch(\n              loadCountryCommunitiesRequestAction({\n                country: me.country,\n                communityId: lastId,\n              })\n            );\n          }\n        }\n      }\n    }\n    window.addEventListener('scroll', onScroll);\n\n    return () => window.removeEventListener('scroll', onScroll);\n  }, [hasMoreCommunity, loadCommunitiesLoading, changableCommunities, me]);\n\n  return (\n    <AppLayout>\n      <HomeLayout>\n        <section>\n          <h1>새로운 커뮤니티를 만나보세요</h1>\n          <div className=\"cards-container\">\n            {mainCommunities.map(community => (\n              <div key={`new${community.id}`}>\n                <Link href={`/community/${community.id}`} prefetch={false}>\n                  <a>\n                    <BoxStyleCard\n                      profilePhoto={community.profilePhoto}\n                      categoryName={community.Categories[0].name}\n                      country={community.country}\n                      communityName={community.communityName}\n                    />\n                  </a>\n                </Link>\n              </div>\n            ))}\n          </div>\n        </section>\n\n        {me && changableCommunities && (\n          <section>\n            <h1>우리동네 커뮤니티</h1>\n            <div className=\"cards-container\">\n              {changableCommunities.map(community => (\n                <div key={`country${community.id}`}>\n                  <Link href={`/community/${community.id}`} prefetch={false}>\n                    <a>\n                      <BoxStyleCard\n                        profilePhoto={community.profilePhoto}\n                        categoryName={community.Categories[0].name}\n                        country={community.country}\n                        communityName={community.communityName}\n                      />\n                    </a>\n                  </Link>\n                </div>\n              ))}\n            </div>\n          </section>\n        )}\n      </HomeLayout>\n    </AppLayout>\n  );\n}\n\nexport const getServerSideProps: GetServerSideProps = wrapper.getServerSideProps(\n  async context => {\n    const cookie = context.req ? context.req.headers.cookie : '';\n    axios.defaults.headers.Cookie = '';\n    if (context.req && cookie) {\n      axios.defaults.headers.Cookie = cookie;\n    }\n    context.store.dispatch(loadMyInfoRequestAction());\n    context.store.dispatch(loadCommunitiesRequestAction());\n    context.store.dispatch(END);\n    await context.store.sagaTask.toPromise();\n  }\n);\n\nexport default memo(Home);\n"]},"metadata":{},"sourceType":"module"}