{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { loadMyInfoRequestAction } from '../actions/actionUser';\nimport { Form, Button } from 'antd';\nimport Head from 'next/head';\nimport Router from 'next/router';\nimport dynamic from 'next/dynamic';\nimport React, { useCallback, useEffect, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { useForm, Controller } from 'react-hook-form';\nimport { addCommunityValidation } from '../utils/yup';\nimport { yupResolver } from '@hookform/resolvers/yup';\nimport SignUpLayout, { InputContainer, TextAreaContainer, ButtonContainer } from 'components/Layouts/FormLayout';\nimport { addCommunityRequestAction, loadCategoriesRequestAction } from 'actions/actionCommunity';\nimport { END } from '@redux-saga/core';\nimport axios from 'axios';\nimport wrapper from 'store/configureStore';\nconst FormErrorMessage = dynamic(() => import('components/Message/FormErrorMessage'), {\n  loadableGenerated: {\n    webpack: () => [require.resolveWeak('components/Message/FormErrorMessage')],\n    modules: ['components/Message/FormErrorMessage']\n  }\n});\nconst SearchAddressModal = dynamic(() => import('components/Modals/SearchAddressModal'), {\n  loadableGenerated: {\n    webpack: () => [require.resolveWeak('components/Modals/SearchAddressModal')],\n    modules: ['components/Modals/SearchAddressModal']\n  }\n});\n\nfunction MakeCommunity() {\n  var _errors$communityName, _errors$description;\n\n  const dispatch = useDispatch();\n  const {\n    me\n  } = useSelector(state => state.user);\n  const {\n    mainCategories,\n    addCommunityDone,\n    addCommunityError,\n    addCommunityLoading\n  } = useSelector(state => state.community);\n  const {\n    0: showSearchAddressModal,\n    1: setShowSearchAddressModal\n  } = useState(false);\n  const {\n    0: countryError,\n    1: setCountryError\n  } = useState(false);\n  const {\n    0: categoryError,\n    1: setcategoryError\n  } = useState(false);\n  const {\n    0: country,\n    1: setCountry\n  } = useState('');\n  const {\n    0: category,\n    1: setCategory\n  } = useState('');\n  useEffect(() => {\n    if (!me) {\n      Router.push('/');\n    }\n  }, [me]);\n  useEffect(() => {\n    if (addCommunityError) {\n      alert(addCommunityError);\n    }\n  }, [addCommunityError]);\n  useEffect(() => {\n    if (addCommunityDone) {\n      alert('커뮤니티를 생성했습니다');\n      Router.push('/');\n    }\n  }, [addCommunityDone]);\n  const {\n    handleSubmit,\n    errors,\n    control\n  } = useForm({\n    resolver: yupResolver(addCommunityValidation),\n    mode: 'onBlur'\n  });\n  const openSearchAddressModal = useCallback(() => {\n    setCountryError(false);\n    setShowSearchAddressModal(true);\n  }, []);\n  const closeSearchAddressModal = useCallback(() => {\n    setShowSearchAddressModal(false);\n  }, []);\n  const onChangeCategory = useCallback(e => {\n    setCategory(e.target.value);\n    setcategoryError(false);\n  }, []);\n  const onSubmit = useCallback(handleSubmit(data => {\n    if (country === '') {\n      return setCountryError(true);\n    }\n\n    if (category === '') {\n      return setcategoryError(true);\n    }\n\n    return dispatch(addCommunityRequestAction({\n      communityName: data.communityName,\n      description: data.description,\n      country,\n      category\n    }));\n  }), [country, category]);\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [/*#__PURE__*/_jsx(Head, {\n      children: /*#__PURE__*/_jsx(\"title\", {\n        children: \"community - \\uCEE4\\uBBA4\\uB2C8\\uD2F0 \\uB9CC\\uB4E4\\uAE30\"\n      })\n    }), /*#__PURE__*/_jsxs(SignUpLayout, {\n      children: [/*#__PURE__*/_jsx(\"h1\", {\n        children: \"\\uCEE4\\uBBA4\\uB2C8\\uD2F0 \\uB9CC\\uB4E4\\uAE30\"\n      }), /*#__PURE__*/_jsxs(Form, {\n        onFinish: onSubmit,\n        className: \"form-grid\",\n        children: [/*#__PURE__*/_jsxs(InputContainer, {\n          children: [/*#__PURE__*/_jsx(\"label\", {\n            htmlFor: \"communityName\",\n            children: \"\\uCEE4\\uBBA4\\uB2C8\\uD2F0 \\uC774\\uB984\"\n          }), /*#__PURE__*/_jsx(\"br\", {}), /*#__PURE__*/_jsx(Controller, {\n            as: /*#__PURE__*/_jsx(\"input\", {}),\n            type: \"text\",\n            name: \"communityName\",\n            control: control,\n            placeholder: \"\\uCEE4\\uBBA4\\uB2C8\\uD2F0 \\uC774\\uB984\\uC744 \\uC785\\uB825\\uD558\\uC138\\uC694\",\n            defaultValue: \"\"\n          }), ((_errors$communityName = errors.communityName) === null || _errors$communityName === void 0 ? void 0 : _errors$communityName.message) && /*#__PURE__*/_jsx(FormErrorMessage, {\n            errorMessage: errors.communityName.message\n          })]\n        }), /*#__PURE__*/_jsxs(TextAreaContainer, {\n          children: [/*#__PURE__*/_jsx(\"label\", {\n            htmlFor: \"description\",\n            children: \"\\uCEE4\\uBBA4\\uB2C8\\uD2F0\\uC18C\\uAC1C\"\n          }), /*#__PURE__*/_jsx(\"br\", {}), /*#__PURE__*/_jsx(Controller, {\n            as: /*#__PURE__*/_jsx(\"textarea\", {}),\n            name: \"description\",\n            placeholder: \"\\uCD5C\\uB300 140\\uAE00\\uC790\\uAE4C\\uC9C0 \\uC785\\uB825\\uAC00\\uB2A5\\uD569\\uB2C8\\uB2E4\",\n            control: control,\n            defaultValue: \"\"\n          }), ((_errors$description = errors.description) === null || _errors$description === void 0 ? void 0 : _errors$description.message) && /*#__PURE__*/_jsx(FormErrorMessage, {\n            errorMessage: errors.description.message\n          })]\n        }), /*#__PURE__*/_jsxs(InputContainer, {\n          children: [/*#__PURE__*/_jsx(\"label\", {\n            htmlFor: \"country\",\n            children: \"\\uC8FC\\uC18C\"\n          }), /*#__PURE__*/_jsx(\"br\", {}), /*#__PURE__*/_jsx(\"input\", {\n            style: {\n              cursor: 'pointer'\n            },\n            value: country,\n            readOnly: true,\n            placeholder: \"\\uC8FC\\uC18C\\uB97C \\uAC80\\uC0C9\\uD558\\uC138\\uC694\",\n            onClick: openSearchAddressModal\n          }), countryError && /*#__PURE__*/_jsx(FormErrorMessage, {\n            errorMessage: \"\\uC8FC\\uC18C\\uB97C \\uC785\\uB825\\uD558\\uC138\\uC694\"\n          })]\n        }), /*#__PURE__*/_jsx(\"label\", {\n          htmlFor: \"categories\",\n          children: \"\\uCE74\\uD14C\\uACE0\\uB9AC\"\n        }), /*#__PURE__*/_jsx(\"br\", {}), /*#__PURE__*/_jsxs(\"select\", {\n          id: \"categories\",\n          className: \"select-category\",\n          onChange: onChangeCategory,\n          children: [/*#__PURE__*/_jsx(\"option\", {\n            value: \"\",\n            children: \"\\uCE74\\uD14C\\uACE0\\uB9AC\\uB97C \\uC120\\uD0DD\\uD558\\uC138\\uC694\"\n          }), mainCategories.map(v => /*#__PURE__*/_jsx(\"option\", {\n            value: v.id,\n            children: v.name\n          }, v.name))]\n        }), categoryError && /*#__PURE__*/_jsx(FormErrorMessage, {\n          errorMessage: \"\\uCE74\\uD14C\\uACE0\\uB9AC\\uB97C \\uC120\\uD0DD\\uD558\\uC138\\uC694\"\n        }), /*#__PURE__*/_jsx(ButtonContainer, {\n          children: /*#__PURE__*/_jsx(Button, {\n            type: \"primary\",\n            htmlType: \"submit\",\n            loading: addCommunityLoading,\n            children: \"\\uC0DD\\uC131\\uD558\\uAE30\"\n          })\n        })]\n      }), showSearchAddressModal && /*#__PURE__*/_jsx(SearchAddressModal, {\n        closeSearchAddressModal: closeSearchAddressModal,\n        setCountry: setCountry,\n        type: \"village\"\n      })]\n    })]\n  });\n}\n\nexport const getServerSideProps = wrapper.getServerSideProps(async context => {\n  const cookie = context.req ? context.req.headers.cookie : '';\n  axios.defaults.headers.Cookie = '';\n\n  if (context.req && cookie) {\n    axios.defaults.headers.Cookie = cookie;\n  }\n\n  context.store.dispatch(loadMyInfoRequestAction());\n  context.store.dispatch(loadCategoriesRequestAction());\n  context.store.dispatch(END);\n  await context.store.sagaTask.toPromise();\n});\nexport default MakeCommunity;","map":{"version":3,"sources":["C:/Users/wlsdn/Desktop/next/community/front/pages/makecommunity.tsx"],"names":["loadMyInfoRequestAction","Form","Button","Head","Router","dynamic","React","useCallback","useEffect","useState","useDispatch","useSelector","useForm","Controller","addCommunityValidation","yupResolver","SignUpLayout","InputContainer","TextAreaContainer","ButtonContainer","addCommunityRequestAction","loadCategoriesRequestAction","END","axios","wrapper","FormErrorMessage","SearchAddressModal","MakeCommunity","dispatch","me","state","user","mainCategories","addCommunityDone","addCommunityError","addCommunityLoading","community","showSearchAddressModal","setShowSearchAddressModal","countryError","setCountryError","categoryError","setcategoryError","country","setCountry","category","setCategory","push","alert","handleSubmit","errors","control","resolver","mode","openSearchAddressModal","closeSearchAddressModal","onChangeCategory","e","target","value","onSubmit","data","communityName","description","message","cursor","map","v","id","name","getServerSideProps","context","cookie","req","headers","defaults","Cookie","store","sagaTask","toPromise"],"mappings":"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","sourcesContent":["import { loadMyInfoRequestAction } from '../actions/actionUser';\r\nimport { Form, Button } from 'antd';\r\nimport Head from 'next/head';\r\nimport Router from 'next/router';\r\nimport dynamic from 'next/dynamic';\r\nimport React, { useCallback, useEffect, useState } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { RootStateInterface } from 'interfaces/RootState';\r\nimport { useForm, Controller } from 'react-hook-form';\r\nimport { addCommunityValidation } from '../utils/yup';\r\nimport { yupResolver } from '@hookform/resolvers/yup';\r\nimport SignUpLayout, {\r\n  InputContainer,\r\n  TextAreaContainer,\r\n  ButtonContainer,\r\n} from 'components/Layouts/FormLayout';\r\nimport {\r\n  addCommunityRequestAction,\r\n  loadCategoriesRequestAction,\r\n} from 'actions/actionCommunity';\r\nimport { END } from '@redux-saga/core';\r\nimport axios from 'axios';\r\nimport { GetServerSideProps } from 'next';\r\nimport wrapper from 'store/configureStore';\r\n\r\nconst FormErrorMessage = dynamic(() => import('components/Message/FormErrorMessage'));\r\nconst SearchAddressModal = dynamic(() => import('components/Modals/SearchAddressModal'));\r\n\r\ntype SignUpType = {\r\n  communityName: string;\r\n  description: string;\r\n};\r\n\r\nfunction MakeCommunity() {\r\n  const dispatch = useDispatch();\r\n  const { me } = useSelector((state: RootStateInterface) => state.user);\r\n  const { mainCategories, addCommunityDone, addCommunityError, addCommunityLoading } =\r\n    useSelector((state: RootStateInterface) => state.community);\r\n\r\n  const [showSearchAddressModal, setShowSearchAddressModal] = useState(false);\r\n  const [countryError, setCountryError] = useState(false);\r\n  const [categoryError, setcategoryError] = useState(false);\r\n  const [country, setCountry] = useState('');\r\n  const [category, setCategory] = useState('');\r\n\r\n  useEffect(() => {\r\n    if (!me) {\r\n      Router.push('/');\r\n    }\r\n  }, [me]);\r\n\r\n  useEffect(() => {\r\n    if (addCommunityError) {\r\n      alert(addCommunityError);\r\n    }\r\n  }, [addCommunityError]);\r\n\r\n  useEffect(() => {\r\n    if (addCommunityDone) {\r\n      alert('커뮤니티를 생성했습니다');\r\n      Router.push('/');\r\n    }\r\n  }, [addCommunityDone]);\r\n\r\n  const { handleSubmit, errors, control } = useForm<SignUpType>({\r\n    resolver: yupResolver(addCommunityValidation),\r\n    mode: 'onBlur',\r\n  });\r\n\r\n  const openSearchAddressModal = useCallback(() => {\r\n    setCountryError(false);\r\n    setShowSearchAddressModal(true);\r\n  }, []);\r\n\r\n  const closeSearchAddressModal = useCallback(() => {\r\n    setShowSearchAddressModal(false);\r\n  }, []);\r\n\r\n  const onChangeCategory = useCallback(e => {\r\n    setCategory(e.target.value);\r\n    setcategoryError(false);\r\n  }, []);\r\n\r\n  const onSubmit = useCallback(\r\n    handleSubmit((data: SignUpType) => {\r\n      if (country === '') {\r\n        return setCountryError(true);\r\n      }\r\n      if (category === '') {\r\n        return setcategoryError(true);\r\n      }\r\n      return dispatch(\r\n        addCommunityRequestAction({\r\n          communityName: data.communityName,\r\n          description: data.description,\r\n          country,\r\n          category,\r\n        })\r\n      );\r\n    }),\r\n    [country, category]\r\n  );\r\n\r\n  return (\r\n    <>\r\n      <Head>\r\n        <title>community - 커뮤니티 만들기</title>\r\n      </Head>\r\n      <SignUpLayout>\r\n        <h1>커뮤니티 만들기</h1>\r\n        <Form onFinish={onSubmit} className=\"form-grid\">\r\n          <InputContainer>\r\n            <label htmlFor=\"communityName\">커뮤니티 이름</label>\r\n            <br />\r\n            <Controller\r\n              as={<input />}\r\n              type=\"text\"\r\n              name=\"communityName\"\r\n              control={control}\r\n              placeholder=\"커뮤니티 이름을 입력하세요\"\r\n              defaultValue=\"\"\r\n            />\r\n            {errors.communityName?.message && (\r\n              <FormErrorMessage errorMessage={errors.communityName.message} />\r\n            )}\r\n          </InputContainer>\r\n\r\n          <TextAreaContainer>\r\n            <label htmlFor=\"description\">커뮤니티소개</label>\r\n            <br />\r\n            <Controller\r\n              as={<textarea />}\r\n              name=\"description\"\r\n              placeholder=\"최대 140글자까지 입력가능합니다\"\r\n              control={control}\r\n              defaultValue=\"\"\r\n            />\r\n            {errors.description?.message && (\r\n              <FormErrorMessage errorMessage={errors.description.message} />\r\n            )}\r\n          </TextAreaContainer>\r\n\r\n          <InputContainer>\r\n            <label htmlFor=\"country\">주소</label>\r\n            <br />\r\n            <input\r\n              style={{ cursor: 'pointer' }}\r\n              value={country}\r\n              readOnly\r\n              placeholder=\"주소를 검색하세요\"\r\n              onClick={openSearchAddressModal}\r\n            />\r\n            {countryError && <FormErrorMessage errorMessage=\"주소를 입력하세요\" />}\r\n          </InputContainer>\r\n\r\n          <label htmlFor=\"categories\">카테고리</label>\r\n          <br />\r\n          <select id=\"categories\" className=\"select-category\" onChange={onChangeCategory}>\r\n            <option value=\"\">카테고리를 선택하세요</option>\r\n            {mainCategories.map(v => (\r\n              <option key={v.name} value={v.id}>\r\n                {v.name}\r\n              </option>\r\n            ))}\r\n          </select>\r\n          {categoryError && <FormErrorMessage errorMessage=\"카테고리를 선택하세요\" />}\r\n\r\n          <ButtonContainer>\r\n            <Button type=\"primary\" htmlType=\"submit\" loading={addCommunityLoading}>\r\n              생성하기\r\n            </Button>\r\n          </ButtonContainer>\r\n        </Form>\r\n        {showSearchAddressModal && (\r\n          <SearchAddressModal\r\n            closeSearchAddressModal={closeSearchAddressModal}\r\n            setCountry={setCountry}\r\n            type=\"village\"\r\n          />\r\n        )}\r\n      </SignUpLayout>\r\n    </>\r\n  );\r\n}\r\n\r\nexport const getServerSideProps: GetServerSideProps = wrapper.getServerSideProps(\r\n  async context => {\r\n    const cookie = context.req ? context.req.headers.cookie : '';\r\n    axios.defaults.headers.Cookie = '';\r\n    if (context.req && cookie) {\r\n      axios.defaults.headers.Cookie = cookie;\r\n    }\r\n    context.store.dispatch(loadMyInfoRequestAction());\r\n    context.store.dispatch(loadCategoriesRequestAction());\r\n    context.store.dispatch(END);\r\n    await context.store.sagaTask.toPromise();\r\n  }\r\n);\r\n\r\nexport default MakeCommunity;\r\n"]},"metadata":{},"sourceType":"module"}