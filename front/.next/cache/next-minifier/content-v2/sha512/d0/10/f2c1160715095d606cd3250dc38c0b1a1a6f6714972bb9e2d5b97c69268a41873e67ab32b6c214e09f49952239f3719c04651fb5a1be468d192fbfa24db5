{"code":"(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[51],{MNTT:function(e,t,n){\"use strict\";n.r(t);var r=n(\"nKUr\"),c=n(\"ODXe\"),a=n(\"7pp9\"),i=n(\"Avh3\"),o=n(\"2/Rp\"),l=n(\"Vl3Y\"),s=n(\"5rEg\"),u=n(\"q1tI\"),b=n(\"/MKj\"),j=n(\"2BaD\"),d=n(\"vOnD\"),m=n(\"20a2\"),f=Object(d.b)(o.a).withConfig({displayName:\"PostForm__StyleButton\",componentId:\"sc-458sc1-0\"})([\"background:none;border:none;position:absolute;margin-left:-35px;color:#fff;margin-top:-5px;:hover{background:none;color:#039be5;}\"]);function p(){var e=Object(m.useRouter)(),t=Object(b.c)((function(e){return e.post})),n=t.imagePaths,d=t.addPostDone,p=Object(b.b)(),O=Object(i.a)(\"\"),h=Object(c.a)(O,3),g=h[0],x=h[1],y=h[2];Object(u.useEffect)((function(){d&&y(\"\")}),[d]);var v=Object(u.useCallback)((function(){if(!g||!g.trim())return alert(\"\\uac8c\\uc2dc\\uae00\\uc744 \\uc791\\uc131\\ud574\\uc8fc\\uc138\\uc694\");var t=new FormData;return n.forEach((function(e){return t.append(\"image\",e)})),t.append(\"content\",g),p(Object(a.b)({formData:t,communityId:Number(e.query.id)}))}),[g,n]),k=Object(u.useRef)(null),w=Object(u.useCallback)((function(){var e;null===(e=k.current)||void 0===e||e.click()}),[k.current]),C=Object(u.useCallback)((function(e){var t=new FormData;return[].forEach.call(e.target.files,(function(e){t.append(\"image\",e)})),p(Object(a.j)(t))}),[]),D=Object(u.useCallback)((function(e){return function(){return p(Object(a.e)(e))}}),[]);return Object(r.jsxs)(l.a,{style:{height:\"100%\",display:\"flex\",justifyContent:\"center\",flexDirection:\"column\"},encType:\"multipart/form-data\",onFinish:v,children:[n&&Object(r.jsx)(\"div\",{style:{display:\"flex\",marginBottom:\"1rem\"},children:n.map((function(e,t){return Object(r.jsxs)(\"div\",{style:{marginRight:\"1rem\",background:\"rgba(0,0,0,.7)\"},children:[Object(r.jsx)(\"img\",{src:e,style:{width:\"100px\"},alt:e}),Object(r.jsx)(f,{onClick:D(t),children:Object(r.jsx)(j.a,{})})]},e)}))}),Object(r.jsx)(s.a.TextArea,{value:g,onChange:x,maxLength:140,placeholder:\"\\uae00\\uc744 \\uc791\\uc131\\ud558\\uc138\\uc694\",style:{color:\"#fff\",background:\"rgba(0, 0, 0, 0.4)\",border:\"none\",resize:\"none\",height:\"70px\"}}),Object(r.jsxs)(\"div\",{children:[Object(r.jsx)(\"input\",{type:\"file\",name:\"image\",multiple:!0,hidden:!0,ref:k,onChange:C}),Object(r.jsxs)(\"div\",{style:{textAlign:\"end\",marginTop:\"0.5rem\"},children:[Object(r.jsx)(o.a,{onClick:w,children:\"\\uc5c5\\ub85c\\ub4dc\"}),Object(r.jsx)(o.a,{style:{marginLeft:\"0.5rem\"},type:\"primary\",htmlType:\"submit\",children:\"\\uc62c\\ub9ac\\uae30\"})]})]})]})}t.default=Object(u.memo)(p)}}]);","map":{"version":3,"sources":["static/chunks/51.c1b1818c855bb4e11c68.js"],"names":["window","push","MNTT","module","__webpack_exports__","__webpack_require__","r","react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__","C_Users_wlsdn_Desktop_next_community_front_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_1__","_actions_actionPost__WEBPACK_IMPORTED_MODULE_2__","_hooks_useInput__WEBPACK_IMPORTED_MODULE_3__","antd__WEBPACK_IMPORTED_MODULE_4__","antd__WEBPACK_IMPORTED_MODULE_5__","antd__WEBPACK_IMPORTED_MODULE_6__","react__WEBPACK_IMPORTED_MODULE_7__","react_redux__WEBPACK_IMPORTED_MODULE_8__","_ant_design_icons__WEBPACK_IMPORTED_MODULE_9__","styled_components__WEBPACK_IMPORTED_MODULE_10__","next_router__WEBPACK_IMPORTED_MODULE_11__","StyleButton","Object","withConfig","displayName","componentId","PostForm","router","_useSelector","state","post","imagePaths","addPostDone","dispatch","_useInput","_useInput2","text","onChangeText","setText","onSubmit","trim","alert","formData","FormData","forEach","p","append","communityId","Number","query","id","imageInputRef","onClickImageUpload","_imageInputRef$curren","current","click","onChangeImages","e","imageFormData","call","target","files","f","onRemoveImage","style","height","display","justifyContent","flexDirection","encType","onFinish","children","marginBottom","map","v","i","marginRight","background","src","width","alt","onClick","TextArea","value","onChange","maxLength","placeholder","color","border","resize","type","name","multiple","hidden","ref","textAlign","marginTop","marginLeft","htmlType"],"mappings":"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"},"name":"static/chunks/51.c1b1818c855bb4e11c68.js","input":"(window[\"webpackJsonp_N_E\"] = window[\"webpackJsonp_N_E\"] || []).push([[51],{\n\n/***/ \"MNTT\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"nKUr\");\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var C_Users_wlsdn_Desktop_next_community_front_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"ODXe\");\n/* harmony import */ var _actions_actionPost__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"7pp9\");\n/* harmony import */ var _hooks_useInput__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(\"Avh3\");\n/* harmony import */ var antd__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(\"2/Rp\");\n/* harmony import */ var antd__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(\"Vl3Y\");\n/* harmony import */ var antd__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(\"5rEg\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(\"q1tI\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_7__);\n/* harmony import */ var react_redux__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(\"/MKj\");\n/* harmony import */ var _ant_design_icons__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(\"2BaD\");\n/* harmony import */ var styled_components__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(\"vOnD\");\n/* harmony import */ var next_router__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(\"20a2\");\n/* harmony import */ var next_router__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(next_router__WEBPACK_IMPORTED_MODULE_11__);\n\n\n\n\n\n\n\n\n\n\n\nvar StyleButton = /*#__PURE__*/Object(styled_components__WEBPACK_IMPORTED_MODULE_10__[/* default */ \"b\"])(antd__WEBPACK_IMPORTED_MODULE_4__[/* default */ \"a\"]).withConfig({\n  displayName: \"PostForm__StyleButton\",\n  componentId: \"sc-458sc1-0\"\n})([\"background:none;border:none;position:absolute;margin-left:-35px;color:#fff;margin-top:-5px;:hover{background:none;color:#039be5;}\"]);\n\nfunction PostForm() {\n  var router = Object(next_router__WEBPACK_IMPORTED_MODULE_11__[\"useRouter\"])();\n\n  var _useSelector = Object(react_redux__WEBPACK_IMPORTED_MODULE_8__[/* useSelector */ \"c\"])(function (state) {\n    return state.post;\n  }),\n      imagePaths = _useSelector.imagePaths,\n      addPostDone = _useSelector.addPostDone;\n\n  var dispatch = Object(react_redux__WEBPACK_IMPORTED_MODULE_8__[/* useDispatch */ \"b\"])();\n\n  var _useInput = Object(_hooks_useInput__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"])(''),\n      _useInput2 = Object(C_Users_wlsdn_Desktop_next_community_front_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_1__[/* default */ \"a\"])(_useInput, 3),\n      text = _useInput2[0],\n      onChangeText = _useInput2[1],\n      setText = _useInput2[2];\n\n  Object(react__WEBPACK_IMPORTED_MODULE_7__[\"useEffect\"])(function () {\n    if (addPostDone) {\n      setText('');\n    }\n  }, [addPostDone]);\n  var onSubmit = Object(react__WEBPACK_IMPORTED_MODULE_7__[\"useCallback\"])(function () {\n    if (!text || !text.trim()) {\n      return alert('게시글을 작성해주세요');\n    }\n\n    var formData = new FormData();\n    imagePaths.forEach(function (p) {\n      return formData.append('image', p);\n    });\n    formData.append('content', text);\n    return dispatch(Object(_actions_actionPost__WEBPACK_IMPORTED_MODULE_2__[/* addPostRequestAction */ \"b\"])({\n      formData: formData,\n      communityId: Number(router.query.id)\n    }));\n  }, [text, imagePaths]);\n  var imageInputRef = Object(react__WEBPACK_IMPORTED_MODULE_7__[\"useRef\"])(null);\n  var onClickImageUpload = Object(react__WEBPACK_IMPORTED_MODULE_7__[\"useCallback\"])(function () {\n    var _imageInputRef$curren;\n\n    (_imageInputRef$curren = imageInputRef.current) === null || _imageInputRef$curren === void 0 ? void 0 : _imageInputRef$curren.click();\n  }, [imageInputRef.current]);\n  var onChangeImages = Object(react__WEBPACK_IMPORTED_MODULE_7__[\"useCallback\"])(function (e) {\n    var imageFormData = new FormData();\n    [].forEach.call(e.target.files, function (f) {\n      imageFormData.append('image', f);\n    });\n    return dispatch(Object(_actions_actionPost__WEBPACK_IMPORTED_MODULE_2__[/* uploadImagesRequestAction */ \"j\"])(imageFormData));\n  }, []);\n  var onRemoveImage = Object(react__WEBPACK_IMPORTED_MODULE_7__[\"useCallback\"])(function (id) {\n    return function () {\n      return dispatch(Object(_actions_actionPost__WEBPACK_IMPORTED_MODULE_2__[/* removeImage */ \"e\"])(id));\n    };\n  }, []);\n  return /*#__PURE__*/Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__[\"jsxs\"])(antd__WEBPACK_IMPORTED_MODULE_5__[/* default */ \"a\"], {\n    style: {\n      height: '100%',\n      display: 'flex',\n      justifyContent: 'center',\n      flexDirection: 'column'\n    },\n    encType: \"multipart/form-data\",\n    onFinish: onSubmit,\n    children: [imagePaths && /*#__PURE__*/Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__[\"jsx\"])(\"div\", {\n      style: {\n        display: 'flex',\n        marginBottom: '1rem'\n      },\n      children: imagePaths.map(function (v, i) {\n        return /*#__PURE__*/Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__[\"jsxs\"])(\"div\", {\n          style: {\n            marginRight: '1rem',\n            background: 'rgba(0,0,0,.7)'\n          },\n          children: [/*#__PURE__*/Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__[\"jsx\"])(\"img\", {\n            src: v,\n            style: {\n              width: '100px'\n            },\n            alt: v\n          }), /*#__PURE__*/Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__[\"jsx\"])(StyleButton, {\n            onClick: onRemoveImage(i),\n            children: /*#__PURE__*/Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__[\"jsx\"])(_ant_design_icons__WEBPACK_IMPORTED_MODULE_9__[/* default */ \"a\"], {})\n          })]\n        }, v);\n      })\n    }), /*#__PURE__*/Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__[\"jsx\"])(antd__WEBPACK_IMPORTED_MODULE_6__[/* default */ \"a\"].TextArea, {\n      value: text,\n      onChange: onChangeText,\n      maxLength: 140,\n      placeholder: \"\\uAE00\\uC744 \\uC791\\uC131\\uD558\\uC138\\uC694\",\n      style: {\n        color: '#fff',\n        background: 'rgba(0, 0, 0, 0.4)',\n        border: 'none',\n        resize: 'none',\n        height: '70px'\n      }\n    }), /*#__PURE__*/Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__[\"jsxs\"])(\"div\", {\n      children: [/*#__PURE__*/Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__[\"jsx\"])(\"input\", {\n        type: \"file\",\n        name: \"image\",\n        multiple: true,\n        hidden: true,\n        ref: imageInputRef,\n        onChange: onChangeImages\n      }), /*#__PURE__*/Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__[\"jsxs\"])(\"div\", {\n        style: {\n          textAlign: 'end',\n          marginTop: '0.5rem'\n        },\n        children: [/*#__PURE__*/Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__[\"jsx\"])(antd__WEBPACK_IMPORTED_MODULE_4__[/* default */ \"a\"], {\n          onClick: onClickImageUpload,\n          children: \"\\uC5C5\\uB85C\\uB4DC\"\n        }), /*#__PURE__*/Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__[\"jsx\"])(antd__WEBPACK_IMPORTED_MODULE_4__[/* default */ \"a\"], {\n          style: {\n            marginLeft: '0.5rem'\n          },\n          type: \"primary\",\n          htmlType: \"submit\",\n          children: \"\\uC62C\\uB9AC\\uAE30\"\n        })]\n      })]\n    })]\n  });\n}\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (/*#__PURE__*/Object(react__WEBPACK_IMPORTED_MODULE_7__[\"memo\"])(PostForm));\n\n/***/ })\n\n}]);","inputSourceMap":{"version":3,"sources":["C:/Users/wlsdn/Desktop/next/community/front/components/PostForm.tsx"],"names":["StyleButton","styled","Button","PostForm","router","useRouter","useSelector","state","post","imagePaths","addPostDone","dispatch","useDispatch","useInput","text","onChangeText","setText","useEffect","onSubmit","useCallback","trim","alert","formData","FormData","forEach","p","append","addPostRequestAction","communityId","Number","query","id","imageInputRef","useRef","onClickImageUpload","current","click","onChangeImages","e","imageFormData","call","target","files","f","uploadImagesRequestAction","onRemoveImage","removeImage","height","display","justifyContent","flexDirection","marginBottom","map","v","i","marginRight","background","width","color","border","resize","textAlign","marginTop","marginLeft","memo"],"mappings":"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","file":"x","sourcesContent":["import {\n  addPostRequestAction,\n  removeImage,\n  uploadImagesRequestAction,\n} from '../actions/actionPost';\nimport useInput from '../hooks/useInput';\nimport { Button, Form, Input } from 'antd';\nimport React, { ChangeEvent, memo, useCallback, useEffect, useRef } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\n\nimport { RootStateInterface } from '../interfaces/RootState';\nimport { CloseCircleOutlined } from '@ant-design/icons';\nimport styled from 'styled-components';\nimport { useRouter } from 'next/router';\n\nconst StyleButton = styled(Button)`\n  background: none;\n  border: none;\n  position: absolute;\n  margin-left: -35px;\n  color: #fff;\n  margin-top: -5px;\n\n  :hover {\n    background: none;\n    color: #039be5;\n  }\n`;\n\nfunction PostForm() {\n  const router = useRouter();\n  const { imagePaths, addPostDone } = useSelector(\n    (state: RootStateInterface) => state.post\n  );\n  const dispatch = useDispatch();\n  const [text, onChangeText, setText] = useInput<string>('');\n\n  useEffect(() => {\n    if (addPostDone) {\n      setText('');\n    }\n  }, [addPostDone]);\n\n  const onSubmit = useCallback(() => {\n    if (!text || !text.trim()) {\n      return alert('게시글을 작성해주세요');\n    }\n    const formData = new FormData();\n    imagePaths.forEach(p => formData.append('image', p));\n    formData.append('content', text);\n    return dispatch(\n      addPostRequestAction({ formData, communityId: Number(router.query.id) })\n    );\n  }, [text, imagePaths]);\n\n  const imageInputRef = useRef<HTMLInputElement>(null);\n  const onClickImageUpload = useCallback(() => {\n    imageInputRef.current?.click();\n  }, [imageInputRef.current]);\n\n  const onChangeImages = useCallback((e: ChangeEvent<HTMLInputElement>) => {\n    const imageFormData = new FormData();\n    [].forEach.call(e.target.files, f => {\n      imageFormData.append('image', f);\n    });\n    return dispatch(uploadImagesRequestAction(imageFormData));\n  }, []);\n\n  const onRemoveImage = useCallback(\n    (id: number) => () => {\n      return dispatch(removeImage(id));\n    },\n    []\n  );\n\n  return (\n    <Form\n      style={{\n        height: '100%',\n        display: 'flex',\n        justifyContent: 'center',\n        flexDirection: 'column',\n      }}\n      encType=\"multipart/form-data\"\n      onFinish={onSubmit}\n    >\n      {imagePaths && (\n        <div\n          style={{\n            display: 'flex',\n            marginBottom: '1rem',\n          }}\n        >\n          {imagePaths.map((v, i) => (\n            <div key={v} style={{ marginRight: '1rem', background: 'rgba(0,0,0,.7)' }}>\n              <img src={v} style={{ width: '100px' }} alt={v} />\n              <StyleButton onClick={onRemoveImage(i)}>\n                <CloseCircleOutlined />\n              </StyleButton>\n            </div>\n          ))}\n        </div>\n      )}\n      <Input.TextArea\n        value={text}\n        onChange={onChangeText}\n        maxLength={140}\n        placeholder=\"글을 작성하세요\"\n        style={{\n          color: '#fff',\n          background: 'rgba(0, 0, 0, 0.4)',\n          border: 'none',\n          resize: 'none',\n          height: '70px',\n        }}\n      />\n      <div>\n        <input\n          type=\"file\"\n          name=\"image\"\n          multiple\n          hidden\n          ref={imageInputRef}\n          onChange={onChangeImages}\n        />\n        <div\n          style={{\n            textAlign: 'end',\n            marginTop: '0.5rem',\n          }}\n        >\n          <Button onClick={onClickImageUpload}>업로드</Button>\n          <Button style={{ marginLeft: '0.5rem' }} type=\"primary\" htmlType=\"submit\">\n            올리기\n          </Button>\n        </div>\n      </div>\n    </Form>\n  );\n}\n\nexport default memo(PostForm);\n"]}}